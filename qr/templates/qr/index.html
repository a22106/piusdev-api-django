{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <meta name="description" content="{{ description }}">
    <meta name="keywords" content="{{ keywords }}">
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    <link rel="icon" type="image/x-icon"  href="{% static 'images/favicon.ico' %}">
</head>
<body>
{# navbar #}
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="{% url 'qr:index' %}">QR Code Generator</a>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="{% url 'qr:index' %}">Home</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

{# content #}
<div class="container">
    <h1>QR Code Generator</h1>
    <form action="/" method="post">
        <label>
            {% csrf_token %}
            <input type="text" name="url" placeholder="Enter URL" required>
        </label>
        <button type="submit">Generate QR Code</button>
    </form>

    {% if qr_text %}
        <h2>Generated QR Code:</h2>
        <img id="qr-code" alt="QR Code" src="">
        <p>QR Code for: {{ qr_text }}</p>
        <script>
            fetch("{% url 'qr:qr_image' %}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                body: "text={{ qr_text|urlencode }}"
            })
                .then(response => response.blob())
                .then(blob => {
                    const img = document.getElementById("qr-code");
                    img.src = URL.createObjectURL(blob);
                });
        </script>
    {% endif %}
</div>
</body>
</html>