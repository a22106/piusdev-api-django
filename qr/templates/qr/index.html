{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <meta name="description" content="{{ description }}">
    <meta name="keywords" content="{{ keywords }}">
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    <link rel="icon" type="image/x-icon"  href="{% static 'images/favicon.ico' %}">
</head>
<body>
{# navbar #}
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="{% url 'qr:index' %}">QR Code Generator</a>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="{% url 'qr:index' %}">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'qr:api' %}">API Documentation</a> <!-- Updated Link -->
                </li>
            </ul>
        </div>
    </div>
</nav>

{# content #}
<div class="container">
    <!-- Segmented Button Group for QR Code Type -->
    <div class="mb-3">
        <label class="form-label d-block">Select QR Code Type:</label>
        <div class="btn-group" role="group" aria-label="QR Code Type">
            <input type="radio" class="btn-check" name="qr_type" id="typeUrl" value="url" autocomplete="off" checked>
            <label class="btn btn-outline-primary" for="typeUrl">URL</label>

            <input type="radio" class="btn-check" name="qr_type" id="typeEmail" value="email" autocomplete="off">
            <label class="btn btn-outline-primary" for="typeEmail">Email</label>

            <input type="radio" class="btn-check" name="qr_type" id="typeText" value="text" autocomplete="off">
            <label class="btn btn-outline-primary" for="typeText">Text</label>

            <input type="radio" class="btn-check" name="qr_type" id="typePhone" value="phone" autocomplete="off">
            <label class="btn btn-outline-primary" for="typePhone">Phone Number</label>

            <input type="radio" class="btn-check" name="qr_type" id="typeVcard" value="vcard" autocomplete="off">
            <label class="btn btn-outline-primary" for="typeVcard">V Card</label>

            <input type="radio" class="btn-check" name="qr_type" id="typeWifi" value="wifi" autocomplete="off">
            <label class="btn btn-outline-primary" for="typeWifi">WiFi</label>
        </div>
    </div>

    <h1>QR Code Generator</h1>
    <form action="/" method="post">
        <label>
            {% csrf_token %}
            <input type="text" name="url" placeholder="Enter URL" required>
        </label>
        <button type="submit">Generate QR Code</button>
    </form>

    {% if qr_text %}
        <h2>Generated QR Code:</h2>
        <img id="qr-code" alt="QR Code" src="">
        <p>QR Code for: {{ qr_text }}</p>
        <script>
            fetch("{% url 'qr:qr_image' %}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                body: "text={{ qr_text|urlencode }}"
            })
                .then(response => response.blob())
                .then(blob => {
                    const img = document.getElementById("qr-code");
                    img.src = URL.createObjectURL(blob);
                });
        </script>
    {% endif %}
</div>
</body>
</html>